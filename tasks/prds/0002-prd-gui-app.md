# PRD-0002: WSOP 자동화 GUI 애플리케이션

**버전**: 2.0.0 | **상태**: 📋 계획 중 | **날짜**: 2025-10-17

---

## 📋 개요

### 목적
현재 CLI 기반 WSOP 자동화 시스템을 사용자 친화적인 GUI 데스크톱 애플리케이션으로 전환

### 1줄 요약
WSOP 플레이어 데이터 수집/동기화를 GUI로 제어하고 실시간 모니터링할 수 있는 Windows 데스크톱 앱

---

## 🎯 목표

### 주요 목표
1. **사용성 향상**: 기술 지식 없이도 사용 가능
2. **가시성 제공**: 실시간 진행 상황 및 상태 확인
3. **배포 간소화**: 단일 실행 파일로 패키징

### 성공 지표
- 설정 완료 시간: <5분
- 실행 클릭 수: 1~2회
- 오류 발생 시 자가 진단: >80%

---

## 👥 사용자 스토리

### 주요 페르소나
**이름**: 운영 매니저 김철수
**역할**: WSOP 토너먼트 운영 관리
**기술 수준**: 중급 (Python/CLI 경험 없음)
**니즈**:
- 실시간으로 데이터 동기화 상태 확인
- 문제 발생 시 즉시 파악
- 간단한 클릭으로 수동 실행

### 핵심 스토리

#### Story 1: 첫 설정
```
As a 운영 매니저
I want to GUI로 WSOP 로그인 정보와 Google API 설정
So that 복잡한 .env 파일 편집 없이 바로 사용 가능
```

#### Story 2: 수동 실행
```
As a 운영 매니저
I want to "지금 실행" 버튼 클릭
So that 즉시 최신 플레이어 데이터 동기화
```

#### Story 3: 자동 실행 설정
```
As a 운영 매니저
I want to GUI에서 실행 주기 설정 (30분/1시간/2시간)
So that Task Scheduler 설정 없이 자동 실행
```

#### Story 4: 실시간 모니터링
```
As a 운영 매니저
I want to 진행 바와 상태 메시지 확인
So that 현재 어떤 단계가 실행 중인지 파악
```

#### Story 5: 로그 확인
```
As a 운영 매니저
I want to GUI 내 로그 뷰어로 실행 기록 확인
So that 문제 발생 시 원인 파악
```

---

## 🎨 GUI 설계

### 메인 화면 구성

```
┌─────────────────────────────────────────────────────────┐
│  WSOP Key Player Manager                    [_][□][X]  │
├─────────────────────────────────────────────────────────┤
│  ┌───────────────────────┐  ┌──────────────────────┐   │
│  │  📊 상태               │  │  🔧 설정             │   │
│  ├───────────────────────┤  ├──────────────────────┤   │
│  │ 상태: ⚪ 대기 중       │  │ [⚙️ WSOP 설정]      │   │
│  │ 마지막 실행: 12:00    │  │ [🔑 Google API]      │   │
│  │ 다음 실행: 13:00      │  │ [📅 스케줄 설정]     │   │
│  │                        │  │ [📂 폴더 열기]       │   │
│  │ 처리 현황:            │  └──────────────────────┘   │
│  │ [▓▓▓▓▓░░░░░] 50%     │                              │
│  │ ➡️ CSV 다운로드 중... │  ┌──────────────────────┐   │
│  └───────────────────────┘  │  🎮 제어             │   │
│                              ├──────────────────────┤   │
│  ┌───────────────────────┐  │ [▶️ 지금 실행]       │   │
│  │  📝 로그               │  │ [⏸️ 일시 정지]       │   │
│  ├───────────────────────┤  │ [🔄 자동 실행: ON]   │   │
│  │ [12:00:01] 실행 시작  │  │ [📊 통계 보기]       │   │
│  │ [12:00:08] 로그인 성공│  └──────────────────────┘   │
│  │ [12:00:15] CSV 다운로드│                             │
│  │ [12:00:17] 업로드 완료│  ┌──────────────────────┐   │
│  │ [12:00:19] 마킹 완료  │  │  📈 통계 (오늘)      │   │
│  │ [12:00:20] ✅ 완료    │  ├──────────────────────┤   │
│  │ ... (스크롤)          │  │ 실행 횟수: 12회      │   │
│  └───────────────────────┘  │ 성공: 12회 (100%)    │   │
│                              │ 평균 시간: 18초      │   │
│                              │ Key Players: 5명     │   │
│                              └──────────────────────┘   │
└─────────────────────────────────────────────────────────┘
```

### 설정 다이얼로그

#### 1. WSOP 설정
```
┌───────────────────────────────────────┐
│  WSOP 설정                         [X]│
├───────────────────────────────────────┤
│  사용자명:  [dean.hong@gg...]        │
│  비밀번호:  [●●●●●●●●]  [👁️ 보기]   │
│  URL:       [https://staff...]        │
│                                        │
│  [테스트 로그인]  [취소]  [저장]     │
└───────────────────────────────────────┘
```

#### 2. Google API 설정
```
┌───────────────────────────────────────┐
│  Google API 설정                   [X]│
├───────────────────────────────────────┤
│  Credentials 파일:                    │
│  [credentials.json]  [📁 찾아보기]   │
│                                        │
│  SOURCE 시트 ID:                      │
│  [1bGotri5sqcxt1H07QlU4lxV...]       │
│                                        │
│  TARGET 시트 ID:                      │
│  [19e7eDjoZRFZooghZJF3XmO...]        │
│                                        │
│  [연결 테스트]  [취소]  [저장]       │
└───────────────────────────────────────┘
```

#### 3. 스케줄 설정
```
┌───────────────────────────────────────┐
│  자동 실행 스케줄                   [X]│
├───────────────────────────────────────┤
│  ⚪ 자동 실행 비활성화                │
│  🔘 실행 주기:                        │
│      ( ) 30분마다                     │
│      (•) 1시간마다                    │
│      ( ) 2시간마다                    │
│      ( ) 사용자 정의: [60] 분        │
│                                        │
│  실행 시간대:                         │
│  ☑️ 24시간 실행                      │
│  ☐ 지정 시간: [09:00] ~ [18:00]     │
│                                        │
│  [취소]  [저장 및 시작]              │
└───────────────────────────────────────┘
```

---

## ⚙️ 기능 요구사항

### F1. 기본 제어 (Must Have)

#### F1.1 수동 실행
- **기능**: "지금 실행" 버튼 클릭으로 즉시 실행
- **진행 표시**:
  - 단계별 진행 바 (0-100%)
  - 현재 작업 텍스트 (예: "WSOP 로그인 중...")
  - 예상 남은 시간
- **결과**: 성공/실패 팝업 + 로그

#### F1.2 자동 실행
- **기능**: 설정된 주기로 백그라운드 실행
- **스케줄 옵션**: 30분/1시간/2시간/사용자 정의
- **ON/OFF 토글**: 즉시 활성화/비활성화
- **다음 실행 시간 표시**

#### F1.3 일시 정지/재개
- **일시 정지**: 현재 실행 중단
- **재개**: 마지막 단계부터 계속

---

### F2. 설정 관리 (Must Have)

#### F2.1 WSOP 설정
- 사용자명/비밀번호 입력
- URL 입력 (기본값 제공)
- "테스트 로그인" 버튼 (즉시 검증)
- 암호화 저장

#### F2.2 Google API 설정
- credentials.json 파일 선택
- Spreadsheet ID 입력
- "연결 테스트" 버튼 (권한 확인)

#### F2.3 저장 및 검증
- 입력 필드 유효성 검증
- 설정 파일 자동 생성 (.env)
- 에러 메시지 한글화

---

### F3. 모니터링 (Must Have)

#### F3.1 실시간 상태
- **현재 상태**: 대기/실행 중/완료/오류
- **진행 단계**:
  1. WSOP 로그인
  2. CSV 다운로드
  3. Sheets 업로드
  4. Apps Script 실행
- **진행률**: 0-100% 바

#### F3.2 로그 뷰어
- **실시간 로그**: 최신 100줄
- **로그 레벨 필터**: 전체/오류/경고
- **복사/저장**: 로그 텍스트 복사
- **자동 스크롤**: 최신 로그 자동 표시

#### F3.3 통계
- **오늘**: 실행 횟수/성공률/평균 시간
- **주간**: 7일 실행 추이 그래프
- **Key Players**: 매칭된 플레이어 수

---

### F4. 알림 (Should Have)

#### F4.1 시스템 트레이
- **백그라운드 실행**: 창 최소화 시 트레이로
- **트레이 메뉴**:
  - 지금 실행
  - 창 열기
  - 종료
- **알림 표시**: 실행 완료/오류 시 풍선 알림

#### F4.2 데스크톱 알림
- 실행 완료: "✅ 동기화 완료 (18초)"
- 오류 발생: "❌ 로그인 실패"
- Key Player 발견: "⭐ 새 Key Player 5명 발견"

---

### F5. 고급 기능 (Nice to Have)

#### F5.1 다중 프로필
- 여러 WSOP 계정 등록
- 프로필 전환
- 각 프로필별 독립 실행

#### F5.2 Sheets 직접 보기
- "Sheets 열기" 버튼
- 브라우저에서 TARGET 시트 직접 열기

#### F5.3 수동 마킹
- GUI에서 Key Player 수동 추가/삭제
- SOURCE Confirmed E열 직접 편집

---

## 🛠️ 기술 스택

### GUI 프레임워크 선택

| 프레임워크 | 장점 | 단점 | 추천도 |
|-----------|------|------|--------|
| **PyQt5/PyQt6** | 강력한 기능, 네이티브 Look | 라이선스 복잡 | ⭐⭐⭐ |
| **PySide6** | PyQt와 동일, LGPL | 문서 부족 | ⭐⭐⭐⭐ |
| **tkinter** | Python 내장, 간단 | 디자인 제한 | ⭐⭐ |
| **PySimpleGUI** | 매우 간단 | 커스터마이징 제한 | ⭐⭐⭐⭐⭐ |
| **Electron (Python)** | 웹 기술 활용 | 용량 큼 | ⭐⭐ |

### 추천: **PySimpleGUI** 🏆

**이유**:
1. ✅ **빠른 개발**: 기존 CLI 코드 최소 변경
2. ✅ **간단한 문법**: 학습 곡선 낮음
3. ✅ **충분한 기능**: 우리 요구사항 100% 충족
4. ✅ **단일 파일 패키징**: PyInstaller 호환
5. ✅ **무료**: 개인/상업용 무료

### 기술 스택

```
GUI:          PySimpleGUI 4.60+
패키징:        PyInstaller 5.0+
스케줄링:      APScheduler 3.10+
상태 관리:     threading, queue
로깅:         logging (GUI 통합)
```

---

## 🏗️ 아키텍처

### 레이어 구조

```
┌─────────────────────────────────────────┐
│  GUI Layer (PySimpleGUI)                │
│  - main_window.py                        │
│  - dialogs.py (설정 창)                 │
│  - tray_icon.py (시스템 트레이)         │
└────────────────┬────────────────────────┘
                 │
┌────────────────▼────────────────────────┐
│  Controller Layer                        │
│  - app_controller.py (메인 로직)        │
│  - scheduler.py (자동 실행)             │
│  - config_manager.py (설정 관리)        │
└────────────────┬────────────────────────┘
                 │
┌────────────────▼────────────────────────┐
│  Service Layer (기존 코드 재사용)       │
│  - wsop_scraper.py                       │
│  - sheets_uploader.py                    │
│  - session_manager.py                    │
└─────────────────────────────────────────┘
```

### 파일 구조

```
keyplayer_manager/
├── src/
│   ├── gui/                    # 신규 GUI 코드
│   │   ├── __init__.py
│   │   ├── main_window.py      # 메인 창
│   │   ├── dialogs.py          # 설정 다이얼로그
│   │   ├── tray_icon.py        # 시스템 트레이
│   │   └── styles.py           # UI 스타일
│   │
│   ├── controllers/            # 신규 컨트롤러
│   │   ├── __init__.py
│   │   ├── app_controller.py   # 메인 컨트롤러
│   │   ├── scheduler.py        # 스케줄러
│   │   └── config_manager.py   # 설정 관리
│   │
│   ├── main.py                 # 기존 CLI (유지)
│   ├── gui_main.py             # ⭐ GUI 진입점 (신규)
│   ├── wsop_scraper.py         # 재사용
│   ├── sheets_uploader.py      # 재사용
│   └── session_manager.py      # 재사용
│
├── config/                     # 설정 파일
│   ├── settings.json           # GUI 설정
│   └── .env                    # 기존 환경 변수
│
└── requirements-gui.txt        # GUI 추가 의존성
```

---

## 📦 배포 전략

### 단일 실행 파일 (.exe)

**도구**: PyInstaller

```bash
# 빌드 명령
pyinstaller --onefile --windowed \
  --icon=icon.ico \
  --name="WSOP_KeyPlayer_Manager" \
  --add-data "config;config" \
  src/gui_main.py
```

**결과물**:
```
dist/
└── WSOP_KeyPlayer_Manager.exe  (50-80MB)
```

### 설치 방법

1. **Simple 모드**:
   - .exe 다운로드
   - 더블클릭 실행
   - 첫 실행 시 설정 마법사

2. **Installer 모드** (옵션):
   - Inno Setup으로 설치 프로그램 생성
   - 바탕화면 바로가기 자동 생성
   - 시작 프로그램 등록

---

## 🎨 UI/UX 원칙

### 1. 간결성
- 핵심 기능 3개: 실행/설정/로그
- 한 화면에 모든 정보
- 최소 클릭 (2회 이내)

### 2. 가시성
- 현재 상태 항상 표시
- 진행률 바
- 색상 코딩 (녹색=성공, 빨강=오류)

### 3. 피드백
- 모든 액션에 즉각 응답
- 로딩 중 스피너
- 완료 시 사운드 (옵션)

### 4. 오류 처리
- 친절한 오류 메시지 (한글)
- 해결 방법 제시
- 자동 재시도 옵션

---

## 📊 성능 요구사항

| 항목 | 목표 |
|------|------|
| 앱 시작 시간 | <3초 |
| 메모리 사용량 | <200MB |
| CPU 사용량 (대기) | <1% |
| CPU 사용량 (실행) | <30% |
| 응답 시간 | <100ms |

---

## 🧪 테스트 계획

### 단위 테스트
- 각 컨트롤러 함수
- 설정 저장/로드
- 스케줄러 로직

### 통합 테스트
- GUI → Controller → Service 흐름
- 자동 실행 주기 검증

### UI 테스트
- 모든 버튼 클릭
- 다이얼로그 열기/닫기
- 진행 바 업데이트

### 사용자 테스트
- 신규 사용자 설정 완료 시간
- 오류 발생 시 자가 해결률

---

## 🚀 개발 로드맵

### Phase 1: 기본 GUI (1주)
- [ ] PySimpleGUI 설치 및 테스트
- [ ] 메인 윈도우 레이아웃
- [ ] "지금 실행" 버튼 연동
- [ ] 진행 바 및 로그 표시

### Phase 2: 설정 관리 (3일)
- [ ] 설정 다이얼로그 구현
- [ ] .env 파일 자동 생성
- [ ] 설정 유효성 검증

### Phase 3: 자동 실행 (3일)
- [ ] APScheduler 통합
- [ ] 스케줄 설정 UI
- [ ] 백그라운드 실행

### Phase 4: 고급 기능 (3일)
- [ ] 시스템 트레이
- [ ] 데스크톱 알림
- [ ] 통계 대시보드

### Phase 5: 패키징 및 배포 (2일)
- [ ] PyInstaller 설정
- [ ] 아이콘 및 리소스
- [ ] 설치 프로그램 (옵션)

**총 소요 시간**: 약 2주

---

## 💰 예산 (선택사항)

### 무료 옵션
- PySimpleGUI: 무료
- PyInstaller: 무료
- 모든 Python 라이브러리: 무료

**총 비용**: $0

### 유료 옵션 (업그레이드 시)
- PySimpleGUI 상업 라이선스: $99 (선택)
- 코드 서명 인증서: $200/년 (선택)

---

## ✅ 수락 기준

### 필수 기준
1. ✅ .exe 파일 더블클릭으로 실행
2. ✅ 설정 완료 시간 <5분
3. ✅ "지금 실행" 버튼 1회 클릭으로 전체 워크플로우 실행
4. ✅ 실시간 진행 상황 표시
5. ✅ 자동 실행 ON/OFF 토글
6. ✅ 로그 뷰어 내장

### 선택 기준
- 시스템 트레이 백그라운드 실행
- 데스크톱 알림
- 통계 대시보드

---

## 📞 이해관계자

- **개발자**: Claude + 사용자 (코드 리뷰)
- **사용자**: 운영 매니저 (UAT)
- **유지보수**: 개발자

---

## 🔗 참조

- [기존 PRD-0001](0001-prd-wsop-automation.md)
- [PySimpleGUI 문서](https://www.pysimplegui.org/)
- [PyInstaller 문서](https://pyinstaller.org/)

---

**작성자**: Claude AI
**승인자**: 사용자
**상태**: ✅ Phase 1-3 구현 완료 (v2.0)

---

## ✅ 구현 완료 상태 (v2.0.0)

### Phase 1: 기본 GUI ✅
- [x] FreeSimpleGUI 5.2.0 설치 (PySimpleGUI 무료 대안)
- [x] 메인 윈도우 레이아웃 (상태/제어/로그/통계)
- [x] "지금 실행" 버튼 + 비동기 실행 (threading)
- [x] 실시간 로그 뷰어 (queue 기반, 스레드 안전)
- [x] 진행 바 및 상태 표시 (색상 코드)

### Phase 2: 설정 관리 ✅
- [x] WSOP 설정 다이얼로그 (ID/PW/URL)
- [x] Google API 설정 다이얼로그 (SOURCE/TARGET Sheets ID)
- [x] .env 파일 자동 읽기/쓰기
- [x] 설정 유효성 검증

### Phase 3: 모니터링 ✅
- [x] 상태 패널 (현재 상태, 마지막 실행, 다음 예정)
- [x] 실시간 로그 출력 (Multiline 위젯)
- [x] 통계 대시보드 (실행 횟수, CSV 행 수, Key Player 수)
- [x] 로그 폴더 빠른 접근 (Windows/Mac/Linux 지원)

### 실행 파일
- `src/gui_main.py` - GUI 진입점 (338줄)
- `src/gui/main_window.py` - 메인 윈도우 클래스 (159줄)

### 향후 계획 (Phase 4-7)
- [ ] 자동 실행 스케줄러 (APScheduler) - T5
- [ ] 시스템 트레이 통합 (pystray) - T6
- [ ] 데스크톱 알림 (성공/실패) - T6
- [ ] PyInstaller 패키징 (.exe 단일 파일) - T8
- [ ] 멀티 프로필 관리 - T7
